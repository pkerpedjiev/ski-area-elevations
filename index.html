
<!DOCTYPE html>
<meta charset="utf-8">
<html>
<title>Ski Area Elevations</title>
<link rel='stylesheet' href='/css/ski-area-elevations.css'>

<div id="resort-list" style="position: fixed; top: 300px; left: 0; height: 300px"></div>
<div id="ski-area-elevations"></div>

    <script src="/js/lib/d3.min.js"></script>
    <script src="/js/ski-area-elevations.js"></script>
    <script src="/js/d3-zoomable-labels.js"></script>
    <script src="/js/lib/d3-zoom-pan-extent.js"></script>
    <script>
        var elevationsPlot = skiAreaElevationsPlot()
        .width(550)
        .height(300);

        var continent = 'south-america'

        d3.json('/jsons/ski-areas/' + continent + '/uids-to-names.json', function(error, uids_to_names) {
            d3.json('jsons/tiles/tile_info.json', function(error, tile_info) {
                console.log('tile_info:', tile_info);
                elevationsPlot.minX(tile_info.min_pos)
                .maxX(tile_info.max_pos)
                .maxZoom(tile_info.max_zoom);
                
                d3.json('/jsons/processed-ski-area-elevations.json', function(error, data) {
                    data.map(function(d) {
                        if (d.uid in uids_to_names) {
                            d.name = uids_to_names[d.uid];
                        } else {
                            d.name = '*';
                        }
                    });
                    console.log('data', data[30]);
                    d3.select('#ski-area-elevations')
                        .datum(data)
                        .call(elevationsPlot)
                });
            });
        });

    </script>
</html>
